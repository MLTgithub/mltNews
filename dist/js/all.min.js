angular.module("myApp",["ionic","myApp.httpFactory","myApp.slideBox","myApp.news","myApp.live","myApp.talk","myApp.my","myApp.newsDetail"]).config(["$stateProvider","$urlRouterProvider","$ionicConfigProvider",function(t,e,o){o.views.transition("ios"),o.tabs.position("bottom"),o.navBar.alignTitle("center"),o.tabs.style("standard"),t.state("tabs",{url:"/tabs",abstract:!0,templateUrl:"tabs.html",controller:"tabsController"}),e.otherwise("/tabs/news")}]).controller("tabsController",["$scope",function(t){}]),angular.module("myApp.live",[]).config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("tabs.live",{url:"/live",views:{"tabs-live":{templateUrl:"live.html",controller:"liveController"}}})}]).controller("liveController",["$scope","$sce","$ionicLoading","HttpFactory",function(t,e,o,n){t.show=function(){o.show({template:"Loading..."})},t.hide=function(){o.hide()},t.show(),t.CHU=function(t){var e=angular.element(t.target).parent().children();e.css("borderBottom","none"),angular.element(t.target).css("borderBottom","5px solid white")},t.live={slideSource:[]};var i="http://data.live.126.net/livechannel/previewlist.json";n.getData(i).then(function(e){t.hide();var o=[];if(e.top.length){for(var n=0;n<e.top.length;n++){var i={title:e.top[n].roomName,imgsrc:e.top[n].image};o.push(i)}t.live.slideSource=o}});var r="http://data.live.126.net/livechannel/previewlist.json";n.getData(r).then(function(e){t.nooes=e.sublives,t.lives=e.live_review,t.tiaos=e.future})}]),angular.module("myApp.my",[]).config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("tabs.my",{url:"/my",views:{"tabs-my":{templateUrl:"my.html",controller:"myController"}}}).state("tabs.login",{url:"/login",views:{"tabs-my":{templateUrl:"login.html",controller:"myController"}}})}]).controller("myController",["$scope","$ionicBackdrop",function(t,e){var o=0;t.action=function(){o++,o%2==0?e.release():e.retain()}}]),angular.module("myApp.news",[]).config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("tabs.news",{url:"/news",views:{"tabs-news":{templateUrl:"news.html",controller:"newsController"}}}).state("tabs.search",{url:"/search",views:{"tabs-news":{templateUrl:"search.html"}}})}]).controller("newsController",["$scope","$ionicPopup","$ionicSlideBoxDelegate","$location","$ionicViewSwitcher","$state","$ionicLoading","$ionicScrollDelegate","HttpFactory",function(t,e,o,n,i,r,a,l,s){t.show=function(){a.show({template:"Loading..."})},t.hide=function(){a.hide()},t.show();var c=document.querySelector(".btns");t.novx=function(){c.style.height="600px"},t.novy=function(){c.style.height="0px"};document.querySelector(".change");t.huan=function(e){"切换栏目"==e.target.innerHTML?(e.target.innerHTML="请添加",t.lutong=!t.lutong):(e.target.innerHTML="切换栏目",t.lutong=!t.lutong)};var d="http://c.m.163.com/nc/topicset/ios/subscribe/manage/listspecial.html";s.getData(d).then(function(e){t.hide(),t.tous=e.tList,t.tous.splice(20,1)}),t.news={newsArray:"",adsArray:[],index:0,isFirst:!0};var d="http://c.m.163.com/recommend/getSubDocPic?tid=T1348647909107&from=toutiao&offset=0&size=10&fn=1&prog=LMA1&passport=&devId=eW7qcXmjWleAjCxp25EgTBBywawDoVwZiZ9SMikG4cGiOa69wsn%2FdeHaaNGRMr2hIIGNeE0nI41SFrBIaL1THA%3D%3D&lat=DJEPdRawaRYCJZwF3SQobA%3D%3D&lon=7J7OmyytD8SqP0pSV1cJJA%3D%3D";s.getData(d).then(function(e){t.news.newsArray=e.T1348647909107,t.news.adsArray=t.news.newsArray[0].ads});var u=0;t.items=[],t.isShowInfinite=!0,t.loadMore=function(){u+=1;var e="http://c.m.163.com/recommend/getSubDocPic?from=toutiao&prog=LMA1&open=&openpath=&fn=1&passport=&devId=%2BnrKMbpU9ZDPUOhb9gvookO3HKJkIOzrIg%2BI9FhrLRStCu%2B7ZneFbZ30i61TL9kY&offset="+u+"&size=10&version=17.1&spever=false&net=wifi&lat=&lon=&ts=1480666192&sign=yseE2FNVWcJVjhvP48U1nPHyzZCKpBKh%2BaOhOE2d6GR48ErR02zJ6%2FKXOnxX046I&encryption=1&canal=appstore";s.getData(e).then(function(e){t.items=t.items.concat(e.tid),t.items.splice(0,1),u>=7&&(t.isShowInfinite=!1),t.$broadcast("scroll.infiniteScrollComplete")})},t.doRefresh=function(){u=10;var e="http://c.m.163.com/recommend/getSubDocPic?from=toutiao&offset="+u+"&size=30";s.getData(e).then(function(e){t.items=e.tid,t.isShowInfinite=!0,t.$broadcast("scroll.refreshComplete")})},t.goToNewsDetail=function(e){var o=t.items[e].docid;r.go("newsDetail",{data:o}),i.nextDirection("forward")}}]),angular.module("myApp.newsDetail",[]).config(["$stateProvider",function(t){t.state("newsDetail",{url:"/newsDetail",templateUrl:"newsDetail.html",controller:"newsDetailController",params:{data:null}})}]).controller("newsDetailController",["$scope","$sce","$stateParams","$ionicLoading","HttpFactory",function(t,e,o,n,i){t.show=function(){n.show({template:"Loading..."})},t.hide=function(){n.hide()},t.show(),t.newsDetail={detail:"",body:""};var r=o.data;t.mlt=!0;var a="http://localhost:3000/?myUrl=http://c.m.163.com/nc/article/"+r+"/full.html";i.getData(a).then(function(e){if(t.hide(),e){t.mlt=!0,t.newsDetail.detail=e[r];var o=t.newsDetail.detail;if(o.img&&o.img.length)for(var n=0;n<o.img.length;n++){var i=o.img[n].pixel.split("*")[0];i>document.body.offsetWidth&&(i=document.body.offsetWidth);var a="width:"+i+"px",l="<img style='"+a+"' src="+o.img[n].src+">";o.body=o.body.replace(o.img[n].ref,l)}}else t.mlt=!1})}]),angular.module("myApp.talk",[]).config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("tabs.talk",{url:"/talk",views:{"tabs-talk":{templateUrl:"talk.html",controller:"talkController"}}})}]).controller("talkController",["$scope","$ionicLoading","HttpFactory",function(t,e,o){t.show=function(){e.show({template:"Loading..."})},t.hide=function(){e.hide()},t.show(),t.XIAN=function(t){var e=angular.element(t.target).parent().children();e.css("borderBottom","none"),angular.element(t.target).css("borderBottom","5px solid white")};var n="http://c.m.163.com/newstopic/list/classification.html";o.getData(n).then(function(e){t.hide(),t.btns=e.data});var i=10;t.isShowInfinite=!0,t.loadMore=function(){i+=10;var e="http://c.m.163.com/newstopic/list/expert/5YyX5Lqs/0-"+i+".html";o.getData(e).then(function(e){t.cons=e.data.expertList,i>=100&&(t.isShowInfinite=!1),t.$broadcast("scroll.infiniteScrollComplete")})},t.doRefresh=function(){i=10;var e="http://c.m.163.com/newstopic/list/expert/5YyX5Lqs/0-"+i+".html";o.getData(e).then(function(e){t.cons=e.data.expertList,t.isShowInfinite=!0,t.$broadcast("scroll.refreshComplete")})},t.attentionStyle={width:"60px",height:"30px","border-radius":"40px",float:"right"},t.changeStyle=function(t){"+关注"==t.target.innerHTML?(t.target.innerHTML="已关注",angular.element(t.target).css("background","gray")):(t.target.innerHTML="+关注",angular.element(t.target).css("background","rgb(239,71,58)"))};var r=document.querySelector(".row"),a=document.querySelector(".xiala"),l=document.querySelector(".ifyou");a.onclick=function(){"270px"==r.style.height?(r.style.height="90px",l.style.transform="rotate(0deg)"):(r.style.height="270px",l.style.transform="rotate(180deg)")}}]),angular.module("myApp.httpFactory",[]).factory("HttpFactory",["$http","$q",function(t,e){return{getData:function(o,n){if(o){var i=e.defer();return o="http://localhost:3000/?myUrl="+encodeURIComponent(o),n=n?n:"GET",t({url:o,method:n,timeout:2e4}).then(function(t){i.resolve(t.data)},function(t){i.reject(t)}),i.promise}}}}]),angular.module("myApp.slideBox",[]).directive("mgSlideBox",[function(){return{restrict:"E",scope:{sourceArray:"="},template:'<div class="topCarousel"><ion-slide-box delegate-handle="topCarouselSlideBox" on-slide-changed="slideHasChanged($index)" auto-play="true" slide-interval="2000" show-pager="true" does-continue="true" ng-if="isShowSlideBox" on-drag="drag($event)"> <ion-slide ng-repeat="ads in sourceArray track by $index" ng-click="goToDetailView($index)"><img ng-src="{{ads.imgsrc}}" class="topCarouselImg"></ion-slide> </ion-slide-box><div class="slideBottomDiv"></div></div>',controller:["$scope","$element","$ionicSlideBoxDelegate",function(t,e,o){t.goToDetailView=function(t){console.log("进入详情页"+t)};var n=e[0].lastElementChild;t.$watch("sourceArray",function(e,o){e&&e.length&&(t.isShowSlideBox=!0,n.innerText=t.sourceArray[0].title)}),t.slideHasChanged=function(e){n.innerText=t.sourceArray[e].title},o.$getByHandle("mainSlideBox").enableSlide(!1),t.drag=function(t){o.$getByHandle("mainSlideBox").enableSlide(!1),t.stopPropagation()}}],replace:!0,link:function(t,e,o){}}}]);